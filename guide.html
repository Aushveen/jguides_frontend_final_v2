<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta content="" name="description">
	<meta name="robots" content="noindex,nofollow">
	<title>View Your Guide</title>

	<meta property="og:locale" content="en_US" />
	<meta property="fb:app_id" content="" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="" />
	<meta property="og:description" content="" />
	<meta property="og:url" content="<?= $url_p; ?>" />
	<meta property="og:site_name" content="" />
	<meta property="og:image" content="" />
	<meta property="og:image:secure_url" content="" />
	<meta property="og:image:width" content="1024" />
	<meta property="og:image:height" content="576" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="" />
	<meta name="twitter:title" content="" />
	<meta name="twitter:description" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:image:alt" content="" />

	<link rel="icon" href="/favicon.ico" type="image/x-icon" />

	<!-- LIBRARIES -->

	<!-- CUSTOM STYLE -->
	<link rel="stylesheet" href="assets/css/bootstrap.css">
	<link rel="stylesheet" href='assets/css/boxicons.min.css'>
	<link rel="stylesheet" href="assets/css/fancybox.min.css">
	<link rel="stylesheet" href="assets/css/all.min.css">
	<link rel="stylesheet" href="assets/css/slick.css">
	<link rel="stylesheet" href="assets/css/slick-theme.css">
	<link rel="stylesheet" href="assets/css/slick.css">
	<link rel="stylesheet" href="assets/css/toastify.min.css">
	<link rel="stylesheet" href="assets/css/aos.css" />
	<link rel="stylesheet" href="assets/css/animate.css">
	<link rel="stylesheet" href="assets/css/style.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Font Awesome v4.7.0 -->
    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>

    <header>
        <!--<section class="top-bar">
          <div class="container">
              <div class="row">
                  <div class="col-md-12">
                      <p>Anxious about your first year? You've come to the right place!</p>
                  </div>
              </div>
          </div>
        </section>
        <section class="logo-bar">
          <div class="container">
              <div class="row align-items-center">
                  <div class="col-md-4">
                      <div class="header-social">
                          <div class="social-imgs">
                              <a href="#"><img src="assets/images/fb.png" alt=""></a>
                              <a href="#"><img src="assets/images/insta.png" alt=""></a>
                              <a href="#"><img src="assets/images/pintrest.png" alt=""></a>
                              <a href="#"><img src="assets/images/youtube.png" alt=""></a>
                          </div>
                          <div class="social-cont">
                              <p> —  Social media</p>
                          </div>
                      </div>
                  </div>
                  <div class="col-md-4">
                      <div class="header-logo">
                          <a href="index.html"><img src="assets/images/logo.png" alt=""></a>
                      </div>
                  </div>
                  <div class="col-md-4">
                      <div class="header-cart">
                          <a href="#"><img src="assets/images/wishlist.png" alt=""></a>
                          <a href="#"><img src="assets/images/cart.png" alt=""></a>
                          <a href="#"><img src="assets/images/user.png" alt=""></a>
                      </div>
                  </div>
              </div>
          </div>
        </section>-->
        
        <section class="navigation">
          <div class="container">
              <div class="col-md-12">
                  <!-- Centered logo within navigation -->
                  <div class="header-logo" style="text-align: center; margin-bottom: 10px;">
                      <a href="index.html"><img src="assets/images/logo.png" alt="Logo"></a>
                  </div>
                  <div class="main-nav">
                      <ul>
                          <li><a href="index.html">Home</a></li>
                          <li><a href="index.html#about-us">About Us</a></li>
                          <li><a href="index.html#products">Products</a></li>
                          <li><a href="guide.html">View Your Guides</a></li>
                          <li><a href="index.html#faqs">FAQ</a></li>
                          <li><a href="index.html#testimonials">Testimonials</a></li>
                          <li><a href="contact.html">Contact Us</a></li>
                      </ul>
                  </div>
              </div>
          </div>
          <button class="openbtn" onclick="openNav()">☰ </button>
        </section>
        
        <div id="mySidebar" class="sidebar">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
          <a href="index.html">Home</a>
          <a href="index.html#about-us">About Us</a>
          <a href="index.html#products">Products</a>
          <a href="guide.html">View Your Guides</a>
          <a href="index.html#faqs">FAQ</a>
          <a href="index.html#testimonials">Testimonials</a>
          <a href="contact.html">Contact Us</a>
        </div>
        
      </header>

<section class="inner-page">
    <div class="container">
        <div class="row">
            <div data-aos="fade-up" data-aos-duration="1500" class="col-md-12">
                <div class="banner-heading">
                    <h1>View Your Guide</h1>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="privacy-policy">
    <div class="view-pdf__container">
        <h2>Get Your Guide</h2>
        <p>Enter your email address and order ID to retrieve your guide:</p>
        <form class="view-pdf__form" id="getGuideForm">
            <input type="email" id="email" name="email" placeholder="Enter your email" required>
            <input type="text" id="orderID" name="orderID" placeholder="Enter your Order ID" required>
            <div class="recaptcha-container" style="display: flex; justify-content: center;">
                <div class="g-recaptcha" data-sitekey="6LetpAEqAAAAAJnhuBi8_Zs5e9dCdiWvTKsmk3Nk"></div>
            </div>            
            <button type="submit" class="btn-primary">Get Guide</button>
        </form>
    </div>
</section>

<section id="loadingSection" style="display: none; text-align: center; padding: 2rem; background: var(--color-bg1);">
    <h3 id="loadingMessage" style="color: var(--color-primary-dark);">Loading...</h3>
    <div id="pdfContainer" class="image-container"></div>
    <div id="linksContainer" style="margin-top: 1rem;"></div>
    <div class="nav-buttons">
        <button id="goLeftButton" class="btn-primary" onclick="goLeft()">Go Left</button>
        <button id="goRightButton" class="btn-primary" onclick="goRight()">Go Right</button>
    </div>
</section>


<footer>
    <section class="footer-main">
        <div class="container">
            <div class="row ">
                <div class="col-md-3">
                    <div class="footer-left">
                        <div class="footer-logo">
                            <img src="assets/images/footer-logo.png" alt="">
                        </div>
                        <div class="footer-content">
                            <p>Your one stop for a successful freshman year</p>
                        </div>
                        <div class="footer-social">
                            <a href="https://www.facebook.com/profile.php?id=61561265210229"><img src="assets/images/fb.png" alt=""></a>
                            <a href="https://www.instagram.com/j.guides/"><img src="assets/images/insta.png" alt=""></a>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="quick-links">
                        <h3>Quick Links</h3>
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li><a href="index.html#about-us">About Us</a></li>
                            <li><a href="index.html#products">Products</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="quick-links">
                        <h3>Questions?</h3>
                        <ul>
                            <li><a href="index.html#faqs">FAQ</a></li>
                            <li><a href="index.html#testimonials">Testimonials</a></li>
                            <li><a href="contact.html">Contact Us</a></li>
                        </ul>
                    </div>
                </div>
                <!--<div class="col-md-3">
                    <div class="other-links">
                        <h3>Other Links</h3>
                        <ul>
                            <li><a href="privacy-policy.html">Privacy Policy</a></li>
                            <li><a href="terms-condition.html">Terms & Conditions</a></li>
                        </ul>
                    </div>
                </div>-->
                <div class="col-md-3">
                    <div class="footer-right">
                        <h3>CONTACT US</h3>
                        <p>Email : <a href="mailto:josh@jguides.com"></a>josh@jguides.com</a></p>
                        <p>Phone : <a href="tel:+17347301602">+1 734 730 1602</a></p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="copright">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="copright-text">
                        <p>Copyright © 2024 JGUIDES - All Rights Reserved.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
</footer>


<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/fancybox.umd.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/slick.js"></script>
<script src="assets/js/wow.js"></script>
<script src="assets/js/aos.js"></script>
<script src="assets/js/toastify-js.js"></script>
<script src="assets/js/boxicons.js"></script>
<script src="assets/js/sweetalert.min.js"></script>
<script src="assets/js/custom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/js/all.min.js" integrity="sha512-1JkMy1LR9bTo3psH+H4SV5bO2dFylgOy+UJhMus1zF4VEFuZVu5lsi4I6iIndE4N9p01z1554ZDcvMSjMaqCBQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    AOS.init();
</script>

<script>

    let images = [];
    let currentIndex = 0;
    let currentOrderId = null;

    // Reset Guide View
    function resetGuideView() {
        images = [];
        currentIndex = 0;
        document.getElementById('pdfContainer').innerHTML = '';
        document.getElementById('linksContainer').innerHTML = '';
    }

    // Display the current image
    function displayImage() {
        const pdfContainer = document.getElementById('pdfContainer');
        const linksContainer = document.getElementById('linksContainer');
        const loadingMessage = document.getElementById('loadingMessage');
        pdfContainer.innerHTML = ''; // Clear existing image
        linksContainer.innerHTML = ''; // Clear existing links

        if (images.length > 0) {
            // Display image
            const img = document.createElement('img');
            img.src = 'data:image/png;base64,' + images[currentIndex];
            img.alt = `Page ${currentIndex + 1}`;
            pdfContainer.appendChild(img);

            // Update loading message
            loadingMessage.textContent = `Page ${currentIndex + 1} of ${images.length}`;

            // Display page-specific links
            const pageLinks = links[currentIndex + 1];
            if (pageLinks) {
                linksContainer.innerHTML = pageLinks;
            }
        } else {
            loadingMessage.textContent = 'No images found.';
        }
    }

    // Go to the next image
    function goRight() {
        if (images.length > 0) {
            currentIndex = (currentIndex + 1) % images.length;
            displayImage();
        }
    }

    // Go to the previous image
    function goLeft() {
        if (images.length > 0) {
            currentIndex = (currentIndex - 1 + images.length) % images.length;
            displayImage();
        }
    }

    // Swipe Gesture Support
    let touchStartX = 0;
    let touchEndX = 0;

    function handleGesture() {
        const minSwipeDistance = 50;
        if (touchEndX < touchStartX - minSwipeDistance) goRight();
        if (touchEndX > touchStartX + minSwipeDistance) goLeft();
    }

    document.addEventListener('touchstart', function (e) {
        touchStartX = e.changedTouches[0].screenX;
    });

    document.addEventListener('touchend', function (e) {
        touchEndX = e.changedTouches[0].screenX;
        handleGesture();
    });

    const links = {
        22: '<a href="https://beinvolved.indiana.edu/?_gl=1*6fojem*_ga*MTUyNDM2MjQyMS4xNzAzMTc0MDYx*_ga_61CH0D2DQW*MTcwNTk2MjI5Ny44LjEuMTcwNTk2MzQ2Ni40OS4wLjA" class="btn btn-primary" target="_blank">BeINvolved</a>',
        23: `
            <a href="https://studentlife.indiana.edu/involvement-belonging/student-involvement-leadership/leadership-programs/index.html" class="btn btn-primary" target="_blank">Leadership Programs 1</a><br>
            <a href="https://studentlife.indiana.edu/get-involved/leadership-programs/index.html" class="btn btn-primary" target="_blank">Leadership Programs 2</a><br>
            <a href="https://iustudentgovernment.indiana.edu/" class="btn btn-primary" target="_blank">IU Student Government</a><br>
            <a href="https://imu.indiana.edu/union-board/index.html" class="btn btn-primary" target="_blank">Union Board</a><br>
            <a href="https://fundiu.indiana.edu/" class="btn btn-primary" target="_blank">Funding Board</a><br>
            <a href="https://studentaffairs.indiana.edu/get-involved/outdoor-adventures/join-the-team.html" class="btn btn-primary" target="_blank">IU Outdoor Adventures</a><br>
            <a href="https://studentemployment.indiana.edu" class="btn btn-primary" target="_blank">Student Employment</a><br>
            <a href="https://studentaffairs.indiana.edu/get-involved/leadership-programs/index.html" class="btn btn-primary" target="_blank">Peer Fac</a>
`,
        24: '<a href="https://luddy.indiana.edu/academics/align/innovation-entrepreneurship/index.html?_gl=1*1h5m7gr*_ga*MTIyNzg5MTgxOS4xNjc4MjkwMTI3*_ga_61CH0D2DQW*MTcwNTk2NTU3NC43OS4xLjE3MDU5NjU2NDguNDYuMC4w&_ga=2.241427527.418170106.1705944480-1227891819.1678290127" class="btn btn-primary" target="_blank">Shoemaker Innovation Center</a><br><a href="https://kelley.iu.edu/programs/undergrad/academics/workshops/index.html" class="btn btn-primary" target="_blank">Kelley Workshops</a>',
        25: `
    <a href="https://studentaffairs.indiana.edu/get-involved/sororities-fraternities/joining/index.html" target="_blank" class="btn btn-primary">Sororities & Fraternities</a><br>
    <a href="https://www.ifcindiana.org" target="_blank" class="btn btn-primary">Interfraternity Council</a><br>
    <a href="https://iumcgc.wixsite.com/mcgc" target="_blank" class="btn btn-primary">Multi-Cultural Greek Council</a><br>
    <a href="https://beinvolved.indiana.edu/organization/nphc" target="_blank" class="btn btn-primary">National Pan-Hellenic Council</a><br>
    <a href="https://www.panhellenicindiana.org/" target="_blank" class="btn btn-primary">Panhellenic Association</a>
            `,
        27: '<a href="https://recsports.indiana.edu/activites/courts.html" target="_blank" class="btn btn-primary">Courts and Fields</a><br><a href="https://imu.indiana.edu/activities-services/bowling-billiards/index.html" target="_blank" class="btn btn-primary">Bowling and Billiards</a>',
        32: '<a href="https://1drv.ms/x/s!AlvCStp-8HUNhBDQN33T-2vmyDUf?e=7EP5IH" target="_blank" class="btn btn-primary">Class Schedule Builder</a><br><a href="https://1drv.ms/x/s!AlvCStp-8HUNhBIMfgrpn0IScicW?e=SWUbO7" target="_blank" class="btn btn-primary">Weekly Planner</a>',
        33: `
    <a href="https://vimeo.com/user221399637/j-guides1" target="_blank" class="btn btn-primary">CLICK ME - WALK-THROUGH 1</a><br>
    <a href="https://vimeo.com/user221399637/j-guides2" target="_blank" class="btn btn-primary">CLICK ME - WALK-THROUGH 2</a>
            `,
        34: `
    <a href="https://vimeo.com/user221399637/j-guides3" target="_blank" class="btn btn-primary">CLICK ME - WALK-THROUGH 3</a>
                `,
        37: '<a href="https://www.cdc.gov/vaccines/schedules/downloads/teen/parent-version-schedule-7-18yrs.pdf" target="_blank" class="btn btn-primary">Download CDC’s 2024 Recommended Immunizations</a>',
        38: '<a href="https://redtutoring.com/" target="_blank" class="btn btn-primary">Red Tutoring</a><br><a href="https://campusts.com/?gclid=Cj0KCQjwncWvBhD_ARIsAEb2HW_vbAaR7PIlSVQXqKNisTGwDtrWbt61GeCvNWgzQaVxJeZGQx8Dk2kaAtd_EALw_wcB" target="_blank" class="btn btn-primary">Campus Tutoring</a><br><a href="https://bloomingtontutors.com/" target="_blank" class="btn btn-primary">Bloomington Tutors</a><br><a href="https://bschooltutors.com/" target="_blank" class="btn btn-primary">B-School Tutors</a>',
        43: '<a href="http://www.twiceexceptional.us" target="_blank" class="btn btn-primary">Twice Exceptional</a>'
    };
    
    document.getElementById('getGuideForm').addEventListener('submit', async function (event) {
        event.preventDefault(); // Prevent default form submission
        
        resetGuideView();

        // Show the loading section and message
        const loadingSection = document.getElementById('loadingSection');
        const loadingMessage = document.getElementById('loadingMessage');
        const pdfContainer = document.getElementById('pdfContainer');
        pdfContainer.innerHTML = ''; // Clear any previous images
        loadingSection.style.display = 'block';
        loadingMessage.textContent = 'Loading.';

        // Scroll to the loading section
        loadingSection.scrollIntoView({ behavior: 'smooth', block: 'center' });

        // Start the cycling "Loading..." animation
        let cycleIndex = 0;
        const loadingStates = ['Loading.', 'Loading..', 'Loading...'];
        const loadingInterval = setInterval(() => {
            cycleIndex = (cycleIndex + 1) % loadingStates.length;
            loadingMessage.textContent = loadingStates[cycleIndex];
        }, 500); // Update every 500ms

        const email = event.target.email.value.trim();
        const orderId = event.target.orderID.value.trim();

        // Verify reCAPTCHA before sending the form data
        const token = grecaptcha.getResponse();
        if (!token) {
            clearInterval(loadingInterval); // Stop loading animation
            alert('Please complete the CAPTCHA.');
            return;
        }

        currentOrderId = orderId;

        try {
            // Validate the order
            const orderResponse = await fetch(`https://jguides.onrender.com/orders/${orderId}/${email}/${token}`);
            if (orderResponse.ok) {
                const order = await orderResponse.json();
                const ebookId = order.ebookID;

                // Fetch the images
                const imagesResponse = await fetch(`https://jguides.onrender.com/ebooks/${ebookId}/pdf/${orderId}`);
                if (imagesResponse.ok) {
                    images = await imagesResponse.json();
                    if (images.length > 0) {
                        currentIndex = 0;
                        // Stop loading animation and display the first image
                        clearInterval(loadingInterval);
                        displayImage();
                    } else {
                        clearInterval(loadingInterval);
                        document.getElementById('image-container').innerHTML = '<p>No images found</p>';
                    }
                } else {
                    clearInterval(loadingInterval);
                    const errorMessage = await imagesResponse.text();
                    console.error(`Failed to retrieve images: ${errorMessage}`);
                    alert(`Failed to retrieve images: ${errorMessage}`);
                }
            } else {
                clearInterval(loadingInterval);
                const errorMessage = await orderResponse.text();
                alert(`Invalid order, please make sure your email address and order ID are correct: ${errorMessage}`);
            }
        } catch (error) {
            clearInterval(loadingInterval);
            console.error('Error:', error);
            alert('Server is down, let support know server is down.');
        } finally {
            clearInterval(loadingInterval); // Ensure loading animation stops in all cases
            loadingMessage.textContent = ''; // Optionally clear loading message
        }
    });
</script>

<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<script>
    Fancybox.bind('[data-fancybox="gallery"]', {
        // Your custom options for a specific gallery
    });
</script>

</body>

</html>